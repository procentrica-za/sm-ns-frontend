{"code":"(global.webpackJsonp=global.webpackJsonp||[]).push([[5],{321:function(e,t,n){\"use strict\";n.r(t);var u=n(0),r=function(){return function(){}}(),o=n(159),l=n(158),c=n(14),s=n(19),a=n(11),i=n(9),d=n(17),p=n(319),m=n(100),h=n(87),f=n(240),v=n(4),S=n(250),g=n(25),y=n(152),P=(function(){}(),function(){return function(e,t,n){this.responseStatusCode=e,this.Success=t,this.Message=n}}()),b=n(12),T=n(15),A=function(){function e(e){this.http=e,this._currentAdvertisementTokenPurchaseResult=new y.a(null),Object(v.setString)(\"sm-service-cred-manager-host\",\"http://10.10.100.147:9952\")}return Object.defineProperty(e.prototype,\"currentAdvertisementTokenPurchaseResult\",{get:function(){return this._currentAdvertisementTokenPurchaseResult.asObservable()},enumerable:!0,configurable:!0}),e.prototype.PurchaseAdvertisementToken=function(e,t){var n=this,u=Object(v.getString)(\"sm-service-cred-manager-host\")+\"/purchase\";console.log(u),Object(b.request)({url:u,method:\"PUT\",headers:{\"Content-Type\":\"application/json\"},content:JSON.stringify({id:e,ammount:t}),timeout:5e3}).then(function(e){var t=e.statusCode;if(500===t){var u=new P(500,!1,\"An error has occured whilst trying to connect.\");n._currentAdvertisementTokenPurchaseResult.next(u)}else if(200===t){var r=e.content.toJSON(),o=new P(200,r.success,r.message);n._currentAdvertisementTokenPurchaseResult.next(o)}else{var l=new P(t,!1,e.content.toString());n._currentAdvertisementTokenPurchaseResult.next(l)}},function(e){var t=new P(400,!1,\"An Error has been recieved, please contact support.\");n._currentAdvertisementTokenPurchaseResult.next(t)})},e.prototype.ClearPurchase=function(){this._currentAdvertisementTokenPurchaseResult=new y.a(null)},e.ngInjectableDef=u[\"ɵɵdefineInjectable\"]({factory:function(){return new e(u[\"ɵɵinject\"](T.c))},token:e,providedIn:\"root\"}),e}(),R=n(5),k=function(){function e(e){this.purchaseServ=e}return e.prototype.onProductTap=function(e){var t=e.view.bindingContext;f.buyProduct(t)},e.prototype.ngOnInit=function(){var e=this;this.myProductArray=new g.ObservableArray(0),f.getProducts().then(function(t){t.forEach(function(t){e.product=t,e.myProductArray.push(e.product)})}).catch(function(e){return console.log(e)}),f.on(f.transactionUpdatedEvent,function(t){t.transactionState===S.TransactionState.Restored&&v.setBoolean(t.productIdentifier,!0),t.transactionState===S.TransactionState.Purchased&&(t.productIdentifier.indexOf(\".product1\")>=0&&f.consumePurchase(t.transactionReceipt).then(function(t){0===t&&(e.purchaseServ.PurchaseAdvertisementToken(v.getString(\"userid\"),\"1\"),e.purchaseAdvertisementResultSub=e.purchaseServ.currentAdvertisementTokenPurchaseResult.subscribe(function(t){t&&200===t.responseStatusCode&&R.TNSFancyAlert.showSuccess(\"Success!\",\"Advertisement Tokens Successfully Purchased!\",\"Close\").then(function(t){e.purchaseServ.ClearPurchase()})}))}).catch(function(e){return console.log(e)}),t.productIdentifier.indexOf(\".product3\")>=0?f.consumePurchase(t.transactionReceipt).then(function(t){0===t&&(e.purchaseServ.PurchaseAdvertisementToken(v.getString(\"userid\"),\"5\"),e.purchaseAdvertisementResultSub=e.purchaseServ.currentAdvertisementTokenPurchaseResult.subscribe(function(t){t&&200===t.responseStatusCode&&R.TNSFancyAlert.showSuccess(\"Success!\",\"Advertisement Tokens Successfully Purchased!\",\"Close\").then(function(t){e.purchaseServ.ClearPurchase()})}))}).catch(function(e){return console.log(e)}):v.setBoolean(t.productIdentifier,!0))})},e.prototype.ngOnDestroy=function(){this.purchaseAdvertisementResultSub&&this.purchaseAdvertisementResultSub.unsubscribe(),this.purchaseServ.ClearPurchase()},e}(),w=u[\"ɵcrt\"]({encapsulation:2,styles:[],data:{}});function C(e){return u[\"ɵvid\"](0,[(e()(),u[\"ɵeld\"](0,0,null,null,3,\"GridLayout\",[[\"columns\",\"*, auto\"],[\"padding\",\"5\"],[\"rows\",\"auto, auto\"]],null,null,null,null,null)),(e()(),u[\"ɵeld\"](1,0,null,null,0,\"Label\",[[\"class\",\"h2\"],[\"col\",\"0\"],[\"row\",\"0\"]],[[8,\"text\",0]],null,null,null,null)),(e()(),u[\"ɵeld\"](2,0,null,null,0,\"Label\",[[\"col\",\"0\"],[\"color\",\"#999999\"],[\"row\",\"1\"],[\"textWrap\",\"true\"]],[[8,\"text\",0]],null,null,null,null)),(e()(),u[\"ɵeld\"](3,0,null,null,0,\"Label\",[[\"class\",\"h1\"],[\"col\",\"1\"],[\"row\",\"0\"],[\"rowSpan\",\"2\"],[\"style\",\"margin-left: 5\"]],[[8,\"text\",0]],null,null,null,null))],null,function(e,t){e(t,1,0,t.context.item.localizedTitle),e(t,2,0,t.context.item.localizedDescription),e(t,3,0,t.context.item.priceFormatted)})}function L(e){return u[\"ɵvid\"](0,[(e()(),u[\"ɵeld\"](0,0,null,null,1,\"ns-action-bar\",[],null,null,null,c.b,c.a)),u[\"ɵdid\"](1,49152,null,0,s.a,[a.Page,i.RouterExtensions,d.a],{actionBarTitle:[0,\"actionBarTitle\"],showBackButton:[1,\"showBackButton\"],hasMenu:[2,\"hasMenu\"]},null),(e()(),u[\"ɵeld\"](2,0,null,null,6,\"StackLayout\",[[\"class\",\"advertRadList\"]],null,null,null,null,null)),(e()(),u[\"ɵeld\"](3,0,null,null,5,\"GridLayout\",[[\"class\",\"GridLayoutAdvertListStyle\"],[\"shadow\",\"6\"]],null,null,null,null,null)),(e()(),u[\"ɵeld\"](4,0,null,null,4,\"ListView\",[],null,[[null,\"itemTap\"]],function(e,t,n){var u=!0,r=e.component;\"itemTap\"===t&&(u=!1!==r.onProductTap(n)&&u);return u},p.b,p.a)),u[\"ɵprd\"](6144,null,m.TEMPLATED_ITEMS_COMPONENT,null,[h.ListViewComponent]),u[\"ɵdid\"](6,1490944,null,1,h.ListViewComponent,[u.ElementRef,u.IterableDiffers],{items:[0,\"items\"]},null),u[\"ɵqud\"](603979776,1,{itemTemplateQuery:0}),(e()(),u[\"ɵand\"](0,[[1,2]],null,0,null,C))],function(e,t){var n=t.component;e(t,1,0,\"Shop\",!1,!0),e(t,6,0,n.myProductArray)},null)}var M=u[\"ɵccf\"](\"ns-advert-tokens\",k,function(e){return u[\"ɵvid\"](0,[(e()(),u[\"ɵeld\"](0,0,null,null,1,\"ns-advert-tokens\",[],null,null,null,L,w)),u[\"ɵdid\"](1,245760,null,0,k,[A],null,null)],function(e,t){e(t,1,0)},null)},{},{},[]),_=n(3),O=n(37),x=n(34),N=n(21),D=n(33),E=n(99),I=n(6),F=n(101),j=n(149),B=function(){return function(){}}();n.d(t,\"PurchaseModuleNgFactory\",function(){return z});var z=u[\"ɵcmf\"](r,[],function(e){return u[\"ɵmod\"]([u[\"ɵmpd\"](512,u.ComponentFactoryResolver,u[\"ɵCodegenComponentFactoryResolver\"],[[8,[o.a,l.a,M]],[3,u.ComponentFactoryResolver],u.NgModuleRef]),u[\"ɵmpd\"](4608,_.NgLocalization,_.NgLocaleLocalization,[u.LOCALE_ID,[2,_[\"ɵangular_packages_common_common_a\"]]]),u[\"ɵmpd\"](4608,O.ModalDialogService,O.ModalDialogService,[x.NSLocationStrategy]),u[\"ɵmpd\"](5120,N.DEVICE,N.getDefaultDevice,[]),u[\"ɵmpd\"](5120,D.Frame,N.getDefaultFrame,[]),u[\"ɵmpd\"](5120,a.Page,N.getDefaultPage,[]),u[\"ɵmpd\"](1073742336,_.CommonModule,_.CommonModule,[]),u[\"ɵmpd\"](1073742336,E.NativeScriptCommonModule,E.NativeScriptCommonModule,[]),u[\"ɵmpd\"](1073742336,I.RouterModule,I.RouterModule,[[2,I[\"ɵangular_packages_router_router_a\"]],[2,I.Router]]),u[\"ɵmpd\"](1073742336,F.NativeScriptRouterModule,F.NativeScriptRouterModule,[]),u[\"ɵmpd\"](1073742336,j.a,j.a,[]),u[\"ɵmpd\"](1073742336,B,B,[]),u[\"ɵmpd\"](1073742336,r,r,[]),u[\"ɵmpd\"](1024,I.ROUTES,function(){return[[{path:\"\",component:k,pathMatch:\"full\"}]]},[])])})}}]);","extractedComments":[]}